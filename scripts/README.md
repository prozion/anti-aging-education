# Как сгенерировать страницы данного репозитория

Даже ссылки на образовательные ресурсы представляют собой большой объем информации.
Эта информация содержится в файлах википодобной разметки формата markdown. И когда ее много, редактирование markdown файлов напрямую становится сложным.

Например, переименовав курс, мы должны будем пройтись по десяткам файлов, где данный курс упоминается и поменять его название там.

 Технология или техника, решающая эту проблему, заключается в том, чтобы собрать используемую информацию в концентрированном виде в отдельных текстовых файлах специального формата (и это не markdown!).

 Формат называется Tabtree, и по сути помогает записывать информацию в унифицированной модели триплетов, из которых потом складывается граф знаний, вмещающий в себя какие угодно факты. Эти факты могут быть отфильтрованы, преобразованы и выведены в формат markdown.

Итак, тепреь все ручное редактирование происходит в папке проекта `./knowledge`. Информация по курсам и материалам собрана в файле `./knowledge/courses.tree`.

Скрипты, преобразующие файлы Tabtree находятся в папке `./scripts`. Они генерируют многочисленные страницы отдельных курсов в папке `./pages` вместе с корневыми файлами `README.md`, в которых также автоматически создаются ссылки на сгенерированные страницы курсов. Вручную править файлы с расширением *.md не надо! Все эти правки будут стерты при следующей перегенерации файлов.

Чтобы запустить скрипт, у вас должен быть [установлен Clojure](#установка-clojure)

В терминале зайдите в директорию `./scripts` и запустите репл `lein repl`. Загрузится clojure с библиотеками проекта и необходимыми зависимостями. Когда появится приглашение для ввода кода `scripts.build=> ` просто наберите функцию `(run)` и она сделает всю работу по сборке проекта.

В итоге, markdown файлы обновились, исходя из того что вы изменили или добавили в *.tree файлах. Теперь их можно закоммитить в репозиторий, а репозиторий загрузить на github.com, чтобы его могли просматривать другие люди:

* `git add .`
* `git commit -m "new commit"`
* `git push`

## Github Actions

Можно сделать еще проще, чтобы не устанавливать локально Clojure и не запускать каждый раз РЕПЛ. Github Actions позволяют написат скрипт, который всю генерацию markdown файлов будет проводить при загрузке нового коммита на сервер github (по команде `git push`).

Правда для этого надо будет переключиться на отдельную ветку разработки локально `git checkout dev`, соответственно на сервере вновь созданные файлы (а коммитить изменения в гите надо по-любому) будут коммититься в основную ветку, которая и показывается людям, заходящим по ссылке на страницу репозитория.

Если идея показалась несколько запутанной - пока не заморачивайтесь. Со временем разберемся. Но Github Actions стоит того, ибо в нем можно наколдовать полноценную CMS, и распрощаться с остальными системами работы с контентом вроде Drupal или MediaWiki. Вдохновляющий пример подобной реализации - [Cправочник фронтендера "Дока"](https://github.com/doka-guide/).

## Установка Clojure

### Linux

Откройте терминал. Дальше выполните последовательность команд:

Скачайте bash скрипт Leiningen

`curl https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein > lein`

Переместите его в директорию для исполняемых файлов

`sudo mv lein /usr/local/bin/lein`

Сделайте файл исполняемым

`sudo chmod a+x /usr/local/bin/lein`

Проверьте, что Leiningen установлен

`lein version`

Дальше вся магия работы с Clojure будет происходить через него. В том числе и установка самого языка, т.к. Clojure представляет собой всего-навсего .jar файл для виртуальной машины Java.

Достаточно в директории clojure-проекта будет набрать `lein install` или `lein repl`
